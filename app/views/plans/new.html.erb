<% provide(:title, 'New') %>
<% provide(:class_text, 'signup') %>
<% provide(:button_text, '新規作成') %>
<h1>新規ツーリング企画作成</h1>
<iframe src="https://www.google.com/maps/embed?pb=!1m28!1m12!1m3!1d217894.86964649733!2d130.38251538881326!3d31.424942909034517!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!4m13!3e0!4m5!1s0x353dd455883afeff%3A0x66b9509f1723679a!2z5oyH5a6_!3m2!1d31.2527917!2d130.6330497!4m5!1s0x353e615200e3c53d%3A0x9adcfdad5d5c5885!2z6bm_5YWQ5bO2!3m2!1d31.5968539!2d130.5571392!5e0!3m2!1sja!2sjp!4v1584284760051!5m2!1sja!2sjp" width="600" height="450" frameborder="0" style="border:0;" allowfullscreen="" aria-hidden="false" tabindex="0"></iframe>
<div class="row">
  <div class="col-md-6 col-md-offset-3">
<div id='map'></div>
<!-- 地名入力用のinputを追加 -->
<input id="address" type="textbox" value="Sydney, NSW">

<!-- buttonをクリックしたらcodeAddressを実行　-->
<input type="button" value="Encode" onclick="codeAddress()">

<style>
#map{
  height: 400px;
}
</style>

<script>
/*
mapを関数の外で定義(codeAddressでも使うため)
geocoderを用意
*/

let map
let geocoder

function initMap(){
  // geocoderを初期化
  geocoder = new google.maps.Geocoder()

  map = new google.maps.Map(document.getElementById('map'), {
  center: {lat: -34.397, lng: 150.644},
  zoom: 8
  });
}

function codeAddress(){
  // 入力を取得
  let inputAddress = document.getElementById('address').value;

  // geocodingしたあとmapを移動
  geocoder.geocode( { 'address': inputAddress}, function(results, status) {
    if (status == 'OK') {
　　　　　　　　　　　　// map.setCenterで地図が移動
      map.setCenter(results[0].geometry.location);

　　　　　　　　　　　　// google.maps.MarkerでGoogleMap上の指定位置にマ��カが立つ
      var marker = new google.maps.Marker({
          map: map,
          position: results[0].geometry.location
      });
    } else {
      alert('Geocode was not successful for the following reason: ' + status);
    }
  });
}
</script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB-_U7Sqau0D9Ve36ou981kM5llfUNwcj4&callback=initMap" async defer></script>
    <%= render 'form' %>
  </div>
</div>